<template>
    <lightning-card title="Add Campaign Members">
        <!-- SPINNER ON LOAD -->
        <div if:true={isLoading} class="slds-is-relative" >
            <lightning-spinner alternative-text="Loading..." variant="brand" size="medium"></lightning-spinner>
        </div>

        <!-- CONFIRM MODE -->
        <template lwc:if={isConfirmMode}>
            <div class="slds-var-m-around_medium">
                {confirmationMessage}
            </div>
        </template>

        <!-- STANDARD INPUT MODE -->
        <template lwc:else>
             <!-- SELECT REPORT -->
            <c-combobox lwc:if={reportOptions}
                label="Select a Report"
                object-api-name="Report"
                options={reportOptions}
                value={reportName}
                placeholder="Search by Report Name"
                onselectoption={handleReportSelection}
                disabled={isLoading}
                classes="slds-var-m-around_small"
            ></c-combobox>

            <template lwc:if={reportId}>
                <!-- SELECT CONTACT ID COLUMN -->
                <lightning-combobox
                    name="contactIdColumnPicker"
                    label="Which report column represents the Contact ID?"
                    value={contactIdColumn}
                    placeholder="Select Column"
                    options={contactIdColumnOptions}
                    onchange={handleContactIdColumnSelection}
                    class="slds-var-m-around_small"
                    disabled={isLoading}
                ></lightning-combobox>
                <!-- SELECT DATA TYPE -->
                <lightning-combobox
                    name="dataTypePicker"
                    label="Data Type for Unique Values"
                    value={uniqueKeyDataType}
                    placeholder="Select Data Type"
                    options={dataTypeOptions}
                    onchange={handleDataTypeSelection}
                    class="slds-var-m-around_small"
                    disabled={isLoading}
                ></lightning-combobox>
    
                <template lwc:if={uniqueKeyDataType}>
                    <!-- SELECT UNIQUE KEY COLUMN -->
                    <lightning-combobox
                        name="uniqueKeyColumnPicker"
                        label={uniqueKeyComboboxLabel}
                        value={uniqueKeyColumn}
                        placeholder="Select Column"
                        options={uniqueKeyColumnOptions}
                        onchange={handleUniqueKeyColumnSelection}
                        class="slds-var-m-around_small"
                        disabled={isLoading}
                    ></lightning-combobox>
                    <!-- SELECT MATCHING FIELD ON CONTACT OBJECT -->
                    <lightning-combobox
                        name="mappedContactFieldPicker"
                        label={mappedContactFieldComboboxLabel}
                        value={mappedContactField}
                        placeholder="Select Field"
                        options={contactFieldOptions}
                        onchange={handleMappedContactFieldSelection}
                        class="slds-var-m-around_small"
                        disabled={isLoading}
                    ></lightning-combobox>
                </template>
                
            </template>
        </template>

        <!-- FOOTER -->
        <div slot="footer">
            <template lwc:if={isConfirmMode}>
                <lightning-button
                    variant="neutral"
                    label="Go Back"
                    onclick={handleExitConfirmMode}
                ></lightning-button>
                <lightning-button
                    variant="brand"
                    label="Add Campaign Members"
                    onclick={handleAddCampaignMembers}
                    disabled={campaignMembersNotFound}
                    class="slds-var-p-left_small"
                ></lightning-button>
            </template>
            <template lwc:else>
                <lightning-button
                    variant="brand"
                    label="Submit"
                    onclick={handleSubmit}
                    disabled={submitIsDisabled}
                ></lightning-button>
            </template>
            
        </div>
    </lightning-card>
</template>